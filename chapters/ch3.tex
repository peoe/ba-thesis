\chapter{Optimal Transport}

This section will be dealing with the problem of optimal transport and some results regarding the existence and uniqueness of such transports. There are two important paradigms in the theory of optimal transport. The original formulation is the so called Monge Problem. It was later relaxed by Kantorovich to a more general problem which is easier to handle.

\section{The Monge Problem}
To motivate the formulation of the Monge problem, we consider a mass modelled by a measure on $X$ to be moved to another mass, again modelled by a measure but on $Y$. One might for example imagine a pile of sand or a certain amount of particles being moved from one location to a different one. This transport will incur costs and the goal of optimal transport is to find a ``way of transporting'' the mass to its target whilst accumulating the smallest cost possible, while making sure that no mass is lost.

For this purpose we consider a \textit{cost function} $c(x, y)$, which will give us the cost of moving a particle from position $x$ to position $y$. Ideally this cost function will be continuous or semi-continuous.

To attain the Monge formulation, the transport is modelled via the \textit{push-forward measure} of our original measure. We will later see, that a more general approach to this transport is beneficial in solving for an optimal solution. For now however, we will constrain ourselves to the earlier approach.

\begin{definition}[Push-Forward]\label{PushForward}
	Given a measure $\mu \in \M{X}$ and a measurable map \map[T]{X}{Y}, we define the \textbf{push-forward measure} of $\mu$ under $T$ as a measure on $Y$ by
	\[ \push{\mu}(y) := \mu(T^{-1} (y)). \]
\end{definition}

A very useful consequence of the push-forward is, that we can use it to state the conservation of mass throughout the transport. Imagine we have a starting measure $\mu$ on $X$ and a target measure $\nu$ on $Y$. In order to not lose any mass, it is necessary for
\[ \push{\mu} = \nu \]
to hold. Formally, this means that all elements of the underlying $\sigma$-algebra $\mathcal{Y}$ on $Y$ coincide under the measures $\nu$ and \push{\mu}, i.e.
\[ \forall A \in \mathcal{Y}: \push{\mu}(A) = \nu(A).\]

Another useful step to take is to norm the overall mass. This can be acheived by considering only probability measures on $X$ and $Y$.

We can now formulate the Monge Problem in terms of a cost function and the push-forward. This is a modern version of the provlem originally described by Gaspard Monge in 1781~\cite{Mon1781}.

\begin{definition}[Monge Problem]\label{MongeProb}
	Let $\mu \in \PM{X}, \nu \in \PM{Y}$ be our starting and our target measure, and \map[c]{X\times{}Y}{\RZero{}\cup{}\{\infty\}}{} be a cost function. Then we define the \textbf{Monge Problem} as
	\begin{equation}
		\inf \left\{ \int\limits_X c(x, T(x))~d\mu(x) : T \in \MF{X}{Y}, \push{\mu} = \nu \right\}.
	\end{equation}
	From here on, we will be using the abbreviation (MP) as the name of the Monge Problem, and $\inf \text{(MP)}$ will denote the attained infimum.
\end{definition}

\begin{definition}[Optimal Transport Map]\label{OTM}
	A function $T~\in~\MF{X, Y}$ is called an \textbf{optimal transport map}, if it satisfies
	\[ \int\limits_X c(x, T(x))~d \mu(x) = \inf \text{(MP)}. \]
\end{definition}

This problem in general is not easy to solve. In order to point out the difiiculites we may face, we require the notions of the \textit{dual space}, \textit{weak convergence} and the \textit{support} of a function.

\todoinline{References for Fischer-Riesz (\ref{Rie-Fis}), dual spaces (\ref{DuaSpa}) and weak convergence (\ref{WeakCon})}

\begin{definition}[Dual Space]\label{DuaSpa}
	Let $(X, ||\cdot||)$ be a normed space over \K. We define the \textbf{dual space} of X as the set of all continuous linear functions \map{X}{\K}. Bestowed with the norm $||\varphi||_{X'} := \sup \{ |\varphi(x)| : ||x|| \le 1 \}$, the dual space is a normed space as well.
\end{definition}

\begin{definition}[Weak Convergence]\label{WeakCon}
	Let $(X, ||\cdot||)$ be a normed space, and $(X', ||\cdot||_{X'})$ its dual space. A sequence ${(x_n)}_{\NinN}$ is said to \textbf{converge weakly} to $x \in X$, if
	\[ \forall \varphi \in X': \varphi(x_n) \xrightarrow[\Ninf]{} \varphi(x) \]
	holds. In this case, we write \weak[]{x_n}{x} for \Ninf. The convergence of ${(\varphi(x_n))}_{\NinN}$ is to be understood in the norm $||\cdot||_{X'}$.
\end{definition}

\todoinline{Support definition!}

We can now consider the following two points to illustrate the hardships in dealing with (MP):

Firstly, if one of the two measures were to be discrete, for example of the form $\mu = \delta_{x_0}, x_0 \in X$, and the other is not, (MP) would be infeasible. This can be seen, as $\forall y \in Y: T^{-1}(y) = x_0$ is a requirement for $\push{\mu} = \nu$. In order for $\mu$ to be transported to $\nu$ the transport would require to perform \textit{mass splitting}, which the transport map $T$ does not permit in its traditional definition.

Secondly, as~\cite{San2015} pointed out, the constraint on $T$ in (MP) is not closed under weak convergence. For this we consider the sequence $T_n(x) := \sin(nx)$ on $[0, 2 \pi]$ for \NinN. As
\[ \int_0^{2 \pi} \sin^2(nx)~dx = \frac{4 \pi n - \sin(4\pi n)}{4n} = \pi < \infty, \]
we get ${(T_n)}_{\NinN} \in \ELL{2}[0, 2 \pi]$. Combining $(\ELL{2}[0, 2 \pi])' = \ELL{2}[0, 2 \pi]$, $\forall p \in (1, \infty) : \ELL{p}[0, 2\pi] \subseteq \ELL{1}[0, 2\pi]$ and the Riesz-Fischer theorem~(\ref{Rie-Fis}) results in
\[ \forall \varphi \in \ELL{2}[0, 2\pi]~\exists f \in \ELL{2}[0, 2\pi]: \varphi(T_n) = \inner{f}{T_n} = \int\limits_0^{2\pi} f(x) \sin(nx)~dx. \]
We now employ the Riemann-Lebesgue theorem~(\ref{Rie-Leb}) to see that
\[ \lim\limits_{\Ninf} \varphi(T_n) = \lim\limits_{\Ninf} \inner{f}{T_n} = \lim\limits_{\Ninf} \int\limits_0^{2\pi} f(x) \sin(nx)~dx = 0, \]
i.e. $T_n$ converges weakly to $0$ as \Ninf.

With this result, we can now conclude that $T^2 := \lim T_n^2$ as well as $T := \sqrt{T^2}$ are almost surely $0$ with respect to the Lebesgue measure, as $\lim \inner{T_n}{T_n} = 0$ for \Ninf. Hence our target measure may only be discrete, as otherwise $\leb{\supp{T}} \neq 0 \Leftrightarrow T \neq 0~\lambda\text{-a.s.} \Leftrightarrow T^2 \neq 0~\lambda\text{-a.s.}$. As such, our starting measure may also only be discrete, which is a contradiction to the use of the Lebesgue measure in $\ELL{2}[0, 2\pi]$.

\section{Kantorovich Relaxation}